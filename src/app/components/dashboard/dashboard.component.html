<div class="container mt-4">
  <!-- Header como Card -->
  <div class="card shadow-sm mb-4">
    <div class="card-body p-0">
      <div class="row g-0">
        <!-- Primeiro Bloco: Logo e Descrição -->
        <div class="col-4 border-end d-flex align-items-center">
          <div class="logo-container">
            <img src="assets/images/logo.png" alt="Logo da Empresa" class="logo-img mb-0" />
          </div>
          <div class="dashboard-menu-container">
            <h4 class="dashboard-title">DashBoard<br>/ Produção</h4>
            <div class="menu-icon" (click)="menuAberto = !menuAberto">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 6H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M3 12H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M3 18H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>            
          </div>
        </div>

        <!-- Segundo Bloco: Painel de Métricas -->
        <div class="col-4">
          <div class="d-flex justify-content-around">
            <!-- Tarefas Abertas -->
            <div class="metric-card bg-card-body p-3 text-center flex-grow-1">
              <h6 class="mb-1">Tarefas<br>Abertas</h6>
              <span class="fs-3 text-white fw-bold">{{ totalOpened }}</span>
            </div>
        
            <!-- Tarefas Fechadas -->
            <div class="metric-card bg-card-body p-3 text-center flex-grow-1">
              <h6 class="mb-1">Tarefas<br>Fechadas</h6>
              <span class="fs-3 text-white fw-bold">{{ totalClosed }}</span>
            </div>
        
            <!-- Tarefas Urgentes -->
            <div class="metric-card bg-urgente p-3 text-center flex-grow-1">
              <h6 class="mb-1">Tarefas<br>Fora do Prazo</h6>
              <span class="fs-3 text-white fw-bold">{{ totalOverdue }}</span>
            </div>
          </div>
        </div>

        <!-- Terceiro Bloco: Filtros -->
        <div class="col-4">
          <div class="p-1">
            <!-- Título "Filtros" -->
            <h6 class="text-white label-extrabold mb-3">Filtros</h6>

            <!-- Select para Clientes -->
            <div class="d-flex align-items-center gap-2 mb-3">
              <label class="text-white label-regular">Labels:</label>
              
              <div class="d-flex">
                <div *ngFor="let label of labels.slice(16, 18)" class="label-direct" [style.backgroundColor]="label.color" [style.color]="label.text_color">
                  {{ label.name }}
                </div>
              </div>
              
              <div class="d-flex align-items-center">
                <!-- O select agora mostra apenas o número de labels restantes -->
                <select id="labelSelect" name="labelSelect" class="custom-select flex-grow-1" [(ngModel)]="selectedLabel">
                  <!-- Mostra o número de labels restantes como título (placeholder) -->
                  <option value="" disabled selected>{{ labels.length - 2 }} +</option>
                  
                  <!-- Quando o select for aberto, mostra as opções normalmente -->
                  <option *ngFor="let label of labels.slice(2)" [value]="label.name" [style.backgroundColor]="label.color" [style.color]="label.text_color">
                    {{ label.name }}
                  </option>
                </select>
              </div>
            </div>
            
            
                   
          
            <!-- Selects para Período -->
            <div class="d-flex align-items-center gap-2">
              <label for="periodoSelect" class="text-white label-regular">Período:</label>
            
              <!-- Select aparece apenas se NÃO for personalizado -->
              <div *ngIf="!mostrarCamposDataPersonalizada" class="flex-grow-1">
                <select id="periodoSelect" name="periodoSelect" class="label-select w-100" (change)="alterarPeriodo($event)">
                  <option value="mes_atual">Selecione um Periodo</option>
                  <option value="ultimos_5">Últimos 5 dias</option>
                  <option value="ultimos_15">Últimos 15 dias</option>
                  <option value="ultimos_30">Últimos 30 dias</option>
                  <option value="custom">Personalizado</option>
                </select>
              </div>
            
              <!-- Campos de Data + Botão de Voltar -->
              <div *ngIf="mostrarCamposDataPersonalizada" class="d-flex align-items-center gap-2 flex-grow-1">
                <button class="btn btn-danger custom-back btn-sm d-flex align-items-center justify-content-center" (click)="voltarPeriodo()">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H3.707l4.147-4.146a.5.5 0 0 0-.708-.708l-5 5a.5.5 0 0 0 0 .708l5 5a.5.5 0 0 0 .708-.708L3.707 8.5H14.5A.5.5 0 0 0 15 8z"/>
                  </svg>
                </button>
                
                <input type="date" id="dataInicio" name="dataInicio" [(ngModel)]="dataInicio" class="custom-input label-select">
                <span class="text-white label-regular">até</span>
                <input type="date" id="dataFim" name="dataFim" [(ngModel)]="dataFim" class="custom-input label-select">
              </div>
            
              <button class="btn btn-primary custom-search-button" (click)="aplicarFiltros()">
                <svg xmlns="http://www.w3.org/2000/svg" class="bi bi-search" viewBox="0 0 16 16">
                  <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
        
      </div>
    </div>
  </div>

  <!-- Cards de Categorias -->
  <div class="row mt-4">
    <div *ngFor="let project of projects" class="col-md-4 ">
        <div class="card card-custom">
            <div class="header-card">
                <h5 class="title-custom">{{ project.name }}</h5>
                <p class="tarefas-abertas" title="Tarefas abertas">
                  <span *ngIf="project.totalIssues" style="font-size: 0.5rem; line-height: 0.7rem; position: relative; left: -5px;">
                    Total<br>Geral
                  </span> 
                  {{ project.totalIssuesGeral }}</p>
                <p class="tarefas-abertas" title="Tarefas abertas">
                  <span *ngIf="project.totalIssues" style="font-size: 0.5rem; line-height: 0.7rem; position: relative; left: -5px;">
                    Total<br>Filtradas
                  </span> 
                  {{ project.totalIssues }}</p>
                                
                <!-- <p class="tarefas-abertas" title="Total Geral de Tarefas">{{ project.totalIssuesGeral }}</p> -->
            </div>
            <div class="separator"></div> <!-- Linha separadora -->
            <div class="card-custom position-relative">
                <ul class="list-group list-group-flush lista-custom">
                    <li class="list-group-item"><span class="bullet">•</span> Tarefas abertas dentro do prazo <span class="text-success">{{ project.openedOnTime }}</span></li>
                    <li class="list-group-item"><span class="bullet">•</span> Tarefas abertas fora do prazo <span class="text-danger">{{ project.overdue }}</span></li>
                    <li class="list-group-item"><span class="bullet">•</span> Tarefas fechadas dentro do prazo <span class="text-secondary">{{ project.closedOnTime }}</span></li>
                    <li class="list-group-item"><span class="bullet">•</span> Tarefas fechadas fora do prazo <span class="text-secondary">{{ project.closedLate }}</span></li>
                </ul>
                <button class="btn detalhes-btn position-absolute">+ DETALHES</button>
            </div>
        </div>
    </div>
  </div>

  <!-- Rodapé -->
  <footer class="rodape">
    <div class="versao">
      <p>Versão 0.0.4 - Build: 20250207-0004 (Alpha)</p>
    </div>
    <div class="direitos">
      <p>Todos os direitos reservados</p>
      <img src="assets/images/logomini.png" alt="Logo de rodapé" class="logo-rodape mb-0" />
    </div>
  </footer>
</div>