<div class="container mt-4">
  <!-- Filtros -->
  <div class="row mb-3">
    <div class="col">
      <label for="projectSelect" class="form-label">Escolha um projeto:</label>
      <select id="projectSelect" [(ngModel)]="selectedProjectId" (change)="onProjectSelect()" class="form-select">
        <option *ngFor="let project of projects" [value]="project.id">{{ project.name }}</option>
      </select>
    </div>
    <div class="col">
      <label for="issueStateSelect" class="form-label">Escolha o estado das issues:</label>
      <select id="issueStateSelect" [(ngModel)]="selectedIssueState" (change)="onIssueStateSelect()" class="form-select">
        <option value="all">Todas</option>
        <option value="opened">Abertas</option>
        <option value="closed">Fechadas</option>
      </select>
    </div>
  </div>

  <!-- Filtro de Issues Atrasadas -->
  <div class="form-check form-switch d-flex justify-content-end align-items-center">
    <label class="form-check-label me-3" for="overdueFilterCheck">
      Mostrar apenas issues atrasadas
    </label>
    <input 
      class="form-check-input" 
      type="checkbox" 
      id="overdueFilterCheck" 
      [(ngModel)]="filterOverdue" 
      (change)="onOverdueFilterChange()"
    >
  </div>

  <!-- Total de Issues -->
  <div class="mb-3">
    <h2>Total de Issues: {{ totalIssues }}</h2>
    <h2>Total Geral de Issues: {{ totalIssuesOverall }}</h2>
  </div>

  <!-- Gráfico de Pizza -->
  <div class="mb-4 d-flex justify-content-center">
    <canvas baseChart
      [data]="pieChartData"
      [labels]="pieChartLabels"
      [options]="pieChartOptions"
      [type]="pieChartType"
      [legend]="pieChartLegend">
    </canvas>
  </div>

  <!-- Tabela de Issues -->
  <table class="table table-bordered table-striped">
    <thead class="thead-dark">
      <tr>
        <th>ID</th>
        <th>Título</th>
        <th>Descrição</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let issue of issues">
        <td>{{ issue.id }}</td>
        <td>{{ issue.title }}</td>
        <td>{{ issue.description }}</td>
        <td>
          <span [ngClass]="{
            'badge bg-success': issue.state === 'closed',
            'badge bg-warning': issue.state === 'in_progress',
            'badge bg-primary': issue.state === 'opened',
            'badge bg-info': issue.state === 'testing',
            'badge bg-danger': isOverdue(issue)
          }">
            {{ issue.state }}
          </span>
        </td>
      </tr>
    </tbody>
  </table>
</div>
